<!DOCTYPE html>
    <head>
        <meta charset="utf-8">
        <title>d3</title>

        <script type="text/javascript" src="js/d3.js"></script>
        <script type="text/javascript" src="js/leaflet.js"></script>

        <link rel="stylesheet" type="text/css" href="css/reset.css">
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <link rel="stylesheet" type="text/css" href="css/leaflet.css">

    </head>
    <body>
    <div id="map"></div>

        <form>
            <input type="button" value="Ongelijkheid"
            onclick="selectData('gino',false,false)">
            <input type="button" value="Persvrijheid"
            onclick="selectData('press',false,false)">

<!--             <input type="button" value="Alles"
            onclick="filterAll()">
 -->        </form>

    <script type="text/javascript" src="data/europe.js"></script>

    <script type="text/javascript" src="data/gino.js"></script>
    <script type="text/javascript" src="data/press.js"></script>


    <script type="text/javascript">

        var map = L.map('map').setView([53, 20], 3);

        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6IjZjNmRjNzk3ZmE2MTcwOTEwMGY0MzU3YjUzOWFmNWZhIn0.Y8bhBaUMqFiPrDRW9hieoQ', {
            maxZoom: 18,
            attribution: '',
            id: 'mapbox.light'
        }).addTo(map);


        // control that shows state info on hover
        var info = L.control();

        info.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info');
            this.update();
            return this._div;
        };

        info.update = function (props) {

            this._div.innerHTML = '<h4>Europa ongelijkheid</h4>' +  (props ?
                selectDataOption
                : 'Hover over a state');
        };

        info.addTo(map);

        var selectDataOption = "gino";

        function selectData (option,isGetValue,props) {

            switch(option){
                case "press":
                    console.log("press");
                    var selectDataOption = "press";
                    if (isGetValue) {
                        var value = getPressValue (props)
                    };
                break;

                case "gino":
                    console.log("gino")
                    var selectDataOption = "gino";
                    if (isGetValue) {
                        var value = getGinoValue (props)
                    };
                break;

                default:
                console.log("all")
                var value = -1;

            }

            return value;


        }




        function getPressValue (props) {
            // iterate over each element in the array
            for (var i = 0; i < press.length; i++){
              // look for the entry with a matching `code` value
              if (press[i].code == props.code){
                // console.log(press[i].code)
                // obj[i].name is the matched result
                var value = press[i]["sco2014"];
              }
            }
            return value;
        }

        function getGinoValue (props) {
            // iterate over each element in the array
            for (var i = 0; i < gino.length; i++){
              // look for the entry with a matching `code` value
              if (gino[i].code == props.code){
                // obj[i].name is the matched result
                var value = gino[i]["2013"];
              }
            }
            return value;

        }


        // get color depending on population density value
        function getColor(d) {
            return d > 1000 ? '#800026' :
                   d > 35  ? '#BD0026' :
                   d > 32  ? '#E31A1C' :
                   d > 29  ? '#FC4E2A' :
                   d > 26   ? '#FD8D3C' :
                   d > 23   ? '#FEB24C' :
                   d > 20   ? '#FED976' :
                   d > 0   ? '#FED976' :

                              'transparent';
        }

        function style(feature) {
            return {
                weight: 2,
                opacity: 1,
                color: 'white',
                dashArray: '3',
                fillOpacity: 0.7,
                fillColor: getColor(selectData(selectDataOption,true,feature.properties))
            };
                // fillColor: getColor(feature.properties.population)

        }

        function highlightFeature(e) {
            var layer = e.target;

            layer.setStyle({
                weight: 5,
                color: '#666',
                dashArray: '',
                fillOpacity: 0.7
            });

            if (!L.Browser.ie && !L.Browser.opera) {
                layer.bringToFront();
            }

            info.update(layer.feature.properties);
        }

        var geojson;

        function resetHighlight(e) {
            geojson.resetStyle(e.target);
            info.update();
        }

        function zoomToFeature(e) {
            map.fitBounds(e.target.getBounds());
        }

        function onEachFeature(feature, layer) {
            layer.on({
                mouseover: highlightFeature,
                mouseout: resetHighlight,
                click: zoomToFeature
            });
        }

        geojson = L.geoJson(statesData, {
            style: style,
            onEachFeature: onEachFeature
        }).addTo(map);

        // map.attributionControl.addAttribution('Population data &copy; <a href="http://census.gov/">US Census Bureau</a>');


        var legend = L.control({position: 'bottomright'});

        legend.onAdd = function (map) {

            var div = L.DomUtil.create('div', 'info legend'),
                grades = [0, 10, 20, 50, 100, 200, 500, 1000],
                labels = [],
                from, to;

            for (var i = 0; i < grades.length; i++) {
                from = grades[i];
                to = grades[i + 1];

                labels.push(
                    '<i style="background:' + getColor(from + 1) + '"></i> ' +
                    from + (to ? '&ndash;' + to : '+'));
            }

            div.innerHTML = labels.join('<br>');
            return div;
        };

        legend.addTo(map);

    </script>




<!--         <svg width="500" height="400">
            <rect x="0" y="0" width="100" height="50" />
            <circle cx="100" cy="50" r="50" />
        </svg>
 -->

  <!--       <svg id="my_canvas">
        </svg>

        <form>
            <input type="button" value="<50M" onclick="lessthan50m()">
            <input type="button" value=">50M" onclick="morethan50m()">
            <input type="button" value="AllÃ¼s" onclick="alldatadisplay()">

        </form>
        <script type="text/javascript">
            
            var all_data;
            var display_data;
            var xRect = -70;
            var xTxtRect = -70;

            var svg;

            d3.csv("data/data.csv", function(dataset) {
                all_data = dataset;
                console.log(all_data[0]["land"]);
                
                // alle data laten zien
                display_data = all_data;

                drawGraphic();
            });

            // svg tekenen
            function drawGraphic () {
                svg = d3.select("#my_canvas");

                svg.selectAll("rect")
                    .data(display_data)
                    .enter()
                    .append("rect")
                    .attr("x", function(record) {
                        xRect += 70;
                        return xRect;
                    })
                    .attr("y", 20)
                    .attr("width", 50)
                    // .attr("height", function(record) {
                    //     hRect = Number(record["aantal"] * 4);
                    //     return hRect + "px";
                    // })

                svg.selectAll("text")
                    .data(display_data)
                    .enter()
                    .append("text")
                    .text(function(record) {
                        return record["land"]
                    })
                    .attr("y", 15)
                    .attr("x", function(record) {
                        xTxtRect += 70;
                        return xTxtRect;
                    })

                svg.selectAll("rect")
                    .data(display_data)
                    .transition(1000)
                    .attr("height" ,function(record) {
                        record (record["aantal"] * 5)
                    })




            }

            function clearGraphic () {

                svg.selectAll("rect")
                    .transition()
                    .duration("1000")
                    .attr("height",0);

                svg.selectAll("text")
                    .remove()

            }

            function lessthan50m () {


                console.log(display_data);

                display_data = new Array();


                for (var i = 0; i < all_data.length; i++) {
                    console.log()

                    if (all_data[i]["aantal"] < 50 ) {
                        display_data.push(all_data[i]);

                    };

                };


                console.log(display_data);

                clearGraphic();
                setTimeout(drawGraphic(),1000);

            }

            function morethan50m () {
                clearGraphic ()
 
                // body...
            }

            function alldatadisplay () {
                clearGraphic ()

                // body...
                display_data = all_data;

                drawGraphic();                

            }




        </script>

 -->


</body>
</html>
